{"ast":null,"code":"import _toConsumableArray from \"/Users/jk_mac/Desktop/whoareyou/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _regeneratorRuntime from \"/Users/jk_mac/Desktop/whoareyou/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/Users/jk_mac/Desktop/whoareyou/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/jk_mac/Desktop/whoareyou/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { db } from \"./firebase\";\nimport { addDoc, collection, getDocs } from \"firebase/firestore\";\nvar initState = {\n  rank: [],\n  is_loaded: true\n};\nvar CREATE = \"user/CREATE\";\nvar LOAD = \"user/LOAD\";\nvar ISLOADED = \"user/ISLOADED\";\nexport var CreateUser = function CreateUser(ranking) {\n  return {\n    type: CREATE,\n    ranking: ranking\n  };\n};\n_c = CreateUser;\nexport var LoadUser = function LoadUser(ranking_list) {\n  return {\n    type: LOAD,\n    ranking_list: ranking_list\n  };\n};\n_c2 = LoadUser;\nexport var isLoaded = function isLoaded(is_loaded) {\n  return {\n    type: ISLOADED,\n    is_loaded: is_loaded\n  };\n}; //middlewares\n\nexport var loadRankFB = function loadRankFB() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch) {\n      var ranking_data, rank_list;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch(isLoaded(false));\n              _context.next = 3;\n              return getDocs(collection(db, \"rank\"));\n\n            case 3:\n              ranking_data = _context.sent;\n              rank_list = [];\n              ranking_data.forEach(function (r) {\n                rank_list.push(_objectSpread({}, r.data()));\n              });\n              dispatch(LoadUser(rank_list));\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var addRankFB = function addRankFB(user_ranking) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch) {\n      var docRef;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return addDoc(collection(db, \"rank\"), user_ranking);\n\n            case 2:\n              docRef = _context2.sent;\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}; //Reducer\n\nexport default function reducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initState;\n  var action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  switch (action.type) {\n    case \"user/LOAD\":\n      {\n        return {\n          state: state,\n          rank: action.ranking_list,\n          is_loaded: true\n        };\n      }\n\n    case \"user/CREATE\":\n      {\n        var new_rank = [].concat(_toConsumableArray(state.rank), [action.rank]);\n        return {\n          rank: new_rank\n        };\n      }\n\n    case \"user/ISLOADED\":\n      {\n        return _objectSpread(_objectSpread({}, state), {}, {\n          is_loaded: action.is_loaded\n        });\n      }\n      ;\n\n    default:\n      return state;\n  }\n}\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateUser\");\n$RefreshReg$(_c2, \"LoadUser\");","map":{"version":3,"names":["db","addDoc","collection","getDocs","initState","rank","is_loaded","CREATE","LOAD","ISLOADED","CreateUser","ranking","type","LoadUser","ranking_list","isLoaded","loadRankFB","dispatch","ranking_data","rank_list","forEach","r","push","data","addRankFB","user_ranking","docRef","reducer","state","action","new_rank"],"sources":["/Users/jk_mac/Desktop/whoareyou/src/Desc.jsx"],"sourcesContent":["import {db} from \"./firebase\";\nimport {addDoc, collection, getDocs} from \"firebase/firestore\";\nconst initState = {\n  rank: [],\n  is_loaded : true\n}; \n\nconst CREATE = \"user/CREATE\";\nconst LOAD = \"user/LOAD\";\nconst ISLOADED = \"user/ISLOADED\";\n\nexport const CreateUser = (ranking) => {\n  return { type: CREATE, ranking };\n}\n\nexport const LoadUser = (ranking_list) => {\n  return { type: LOAD, ranking_list};\n}\nexport const isLoaded = (is_loaded)=>{\n  return{type:ISLOADED,   is_loaded};\n}\n//middlewares\n\nexport const loadRankFB = () =>{ \n  return async function (dispatch){\n    dispatch(isLoaded(false));\nconst ranking_data = await getDocs(collection(db,\"rank\"));\nlet rank_list = [];\nranking_data.forEach((r)=>{\n  rank_list.push({...r.data()});\n});\ndispatch(LoadUser(rank_list));\n  }\n}\nexport const addRankFB = (user_ranking)=> {\n  return async function (dispatch){\n    const docRef = await addDoc(collection(db, \"rank\"), user_ranking);\n  }\n}\n\n//Reducer\nexport default function reducer(state = initState, action = {}) {\n  switch (action.type) {\n    case \"user/LOAD\" : {\n      return{state, rank:action.ranking_list, is_loaded:true}\n    }\n    case \"user/CREATE\": {\n      const new_rank = [...state.rank, action.rank];\n      return { rank: new_rank };\n    }\n    case \"user/ISLOADED\":{\n      return{...state, is_loaded:action.is_loaded};\n    };\n    default:\n      return state;\n  }\n}\n"],"mappings":";;;;AAAA,SAAQA,EAAR,QAAiB,YAAjB;AACA,SAAQC,MAAR,EAAgBC,UAAhB,EAA4BC,OAA5B,QAA0C,oBAA1C;AACA,IAAMC,SAAS,GAAG;EAChBC,IAAI,EAAE,EADU;EAEhBC,SAAS,EAAG;AAFI,CAAlB;AAKA,IAAMC,MAAM,GAAG,aAAf;AACA,IAAMC,IAAI,GAAG,WAAb;AACA,IAAMC,QAAQ,GAAG,eAAjB;AAEA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,OAAD,EAAa;EACrC,OAAO;IAAEC,IAAI,EAAEL,MAAR;IAAgBI,OAAO,EAAPA;EAAhB,CAAP;AACD,CAFM;KAAMD,U;AAIb,OAAO,IAAMG,QAAQ,GAAG,SAAXA,QAAW,CAACC,YAAD,EAAkB;EACxC,OAAO;IAAEF,IAAI,EAAEJ,IAAR;IAAcM,YAAY,EAAZA;EAAd,CAAP;AACD,CAFM;MAAMD,Q;AAGb,OAAO,IAAME,QAAQ,GAAG,SAAXA,QAAW,CAACT,SAAD,EAAa;EACnC,OAAM;IAACM,IAAI,EAACH,QAAN;IAAkBH,SAAS,EAATA;EAAlB,CAAN;AACD,CAFM,C,CAGP;;AAEA,OAAO,IAAMU,UAAU,GAAG,SAAbA,UAAa,GAAK;EAC7B;IAAA,sEAAO,iBAAgBC,QAAhB;MAAA;MAAA;QAAA;UAAA;YAAA;cACLA,QAAQ,CAACF,QAAQ,CAAC,KAAD,CAAT,CAAR;cADK;cAAA,OAEkBZ,OAAO,CAACD,UAAU,CAACF,EAAD,EAAI,MAAJ,CAAX,CAFzB;;YAAA;cAEHkB,YAFG;cAGLC,SAHK,GAGO,EAHP;cAITD,YAAY,CAACE,OAAb,CAAqB,UAACC,CAAD,EAAK;gBACxBF,SAAS,CAACG,IAAV,mBAAmBD,CAAC,CAACE,IAAF,EAAnB;cACD,CAFD;cAGAN,QAAQ,CAACJ,QAAQ,CAACM,SAAD,CAAT,CAAR;;YAPS;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAP;;IAAA;MAAA;IAAA;EAAA;AASD,CAVM;AAWP,OAAO,IAAMK,SAAS,GAAG,SAAZA,SAAY,CAACC,YAAD,EAAiB;EACxC;IAAA,uEAAO,kBAAgBR,QAAhB;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACgBhB,MAAM,CAACC,UAAU,CAACF,EAAD,EAAK,MAAL,CAAX,EAAyByB,YAAzB,CADtB;;YAAA;cACCC,MADD;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAP;;IAAA;MAAA;IAAA;EAAA;AAGD,CAJM,C,CAMP;;AACA,eAAe,SAASC,OAAT,GAAiD;EAAA,IAAhCC,KAAgC,uEAAxBxB,SAAwB;EAAA,IAAbyB,MAAa,uEAAJ,EAAI;;EAC9D,QAAQA,MAAM,CAACjB,IAAf;IACE,KAAK,WAAL;MAAmB;QACjB,OAAM;UAACgB,KAAK,EAALA,KAAD;UAAQvB,IAAI,EAACwB,MAAM,CAACf,YAApB;UAAkCR,SAAS,EAAC;QAA5C,CAAN;MACD;;IACD,KAAK,aAAL;MAAoB;QAClB,IAAMwB,QAAQ,gCAAOF,KAAK,CAACvB,IAAb,IAAmBwB,MAAM,CAACxB,IAA1B,EAAd;QACA,OAAO;UAAEA,IAAI,EAAEyB;QAAR,CAAP;MACD;;IACD,KAAK,eAAL;MAAqB;QACnB,uCAAUF,KAAV;UAAiBtB,SAAS,EAACuB,MAAM,CAACvB;QAAlC;MACD;MAAA;;IACD;MACE,OAAOsB,KAAP;EAZJ;AAcD"},"metadata":{},"sourceType":"module"}